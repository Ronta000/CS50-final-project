{% extends "layout.html" %}

{% block title %}
    Quiz
{% endblock %}

{% block main %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Quiz Mode</title>
</head>
<body>
  <h1>Quiz Mode</h1>
  <button onclick="startQuiz()">Start Quiz</button>
  <div id="quiz"></div>
  <button id="submitBtn" style="display:none;" onclick="submitQuiz()">Submit Quiz</button>
  <div id="result"></div>

  <script>
    function startQuiz() {
      let flashcards = JSON.parse(localStorage.getItem("flashcards")) || [];

      if (flashcards.length < 10) {
        alert("You need at least 10 flashcards to start the quiz.");
        return;
      }

      // Shuffle
      flashcards = flashcards.sort(() => Math.random() - 0.5);

      // اختار 10 بس
      let questions = flashcards.slice(0, 10);

      let quizDiv = document.getElementById("quiz");
      quizDiv.innerHTML = "";

      questions.forEach((q, index) => {
        quizDiv.innerHTML += `
          <div>
            <p>${index + 1}. ${q.question}</p>
            <input type="text" id="answer${index}" placeholder="Your answer">
          </div>
        `;
      });

      // Save questions in memory for checking later
      window.currentQuiz = questions;

      document.getElementById("submitBtn").style.display = "block";
    }

    function submitQuiz() {
      let score = 0;
      let questions = window.currentQuiz;

      questions.forEach((q, index) => {
        let userAnswer = document.getElementById("answer" + index).value.trim().toLowerCase();
        let correctAnswer = q.answer.trim().toLowerCase();

        if (userAnswer === correctAnswer) {
          score++;
        }
      });

      document.getElementById("result").innerHTML =
        You got ${score} out of ${questions.length} correct.;
    }
  </script>
</body>
</html>
{% endblock %}